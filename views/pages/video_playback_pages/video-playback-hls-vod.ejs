<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Video Playback - HLS VoD</title>
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300' rel='stylesheet' type='text/css'>
    <script src="./dist/shaka-player.compiled.debug.js"></script>
    <script src="./player/player.js"></script>
    <link rel="stylesheet" type="text/css" href="./dist/controls.css">
    <script src="./dist/shaka-player.ui.js"></script>

</head>

<body>

    <header class="header sticky sticky--top js-header">
        <%- include("../../partials/header-playback") %>
    </header>

    <main>


        <div class="container">
            <div data_test_automation_id="video_playback_heading">
                <h2>Video Playback - HLS VoD</h2>
            </div>

            <div class="body-wide" data_test_automation_id="video_playback_text" <p>
                This is for HLS encrypted video on demand (VoD) playback
                <br>
                <br>
                Below you will find 2 different HLS VoD video assets that you can load into the player. Both are served
                as HLS .m3u8 files from URLs. One is a master manifest with multiple bitrate values and one is a single
                bitrate manifest
                <br>
                In order to
                load the video, simply click on the corresponding poster
                image.
                </p>
            </div>
        </div>

        <div class="container">
            <div data-shaka-player-container id="video-container">
                <video autoplay data-shaka-player id="video-player" style="width:100%;height:100%"
                    poster="./assets/crude_otto.png"></video>
            </div>
            <div id="error_code" style="display:none;"></div>
            <br><br>
        </div>

        <div class="container">
            <input type="checkbox" id="log_variants" onclick='         
                    function myFunction() {
                    // Get the checkbox
                    var checkBox = document.getElementById("log_variants");
                    // Get the output text
                    var text = document.getElementById("text");
                    var initialText = document.getElementById("initial_text");

                    // If the checkbox is checked, display the output text
                    if (checkBox.checked == true) {
                        text.style.display = "block";
                        initialText.style.display = "none";
                        player.addEventListener("adaptation", onAdaptationChange);
                        player.addEventListener("variantchanged", onAdaptationChange);
                    } 
                    }
                    function onAdaptationChange(event) {
                    var tracks = player.getVariantTracks();
                    for (i = 0; i < tracks.length; i++) {
                        if (tracks[i].active) {
                        console.log("Bandwidth: " + tracks[i].bandwidth);
                        console.log("Variant ID: " + tracks[i].id);
                        break;
                        }
                    }
                    }
                    myFunction();'>
            <div data_test_automation_id="variant_console_log_btn" value="Click to see variant changes">
                <a id="initial_text" style="display:block"> Check box to log variant changes in console </a>
                <a id="text" style="display:none">Logging variant changes - Refresh page to disable</a>

            </div>
        </div>

        <div class="container">
            <fieldset>
                <div class="row">
                    <div class="column-2">
                        <img src="./assets/sintel-poster.jpg" style="width: 150px" class="center"
                            onClick='loadPlayer("https://multiplatform-f.akamaihd.net/i/multi/april11/sintel/sintel-hd_,512x288_450_b,640x360_700_b,768x432_1000_b,1024x576_1400_m,.mp4.csmil/master.m3u8"); document.getElementById("error_code").style.display="none"'
                            data_test_automation_id="sintel-hls-button" type="submit" class="ghost-button"
                            value="Load Sintel (HLS-VoD)" title="Load Sintel (HLS)">
                    </div>
                    <div class="column-2">
                        <img src="./assets/tears-of-steel-poster.jpg" style="width: 152px" class="center"
                            onClick='loadPlayer("http://demo.unified-streaming.com/video/tears-of-steel/tears-of-steel.ism/.m3u8"); document.getElementById("error_code").style.display="none"'
                            data_test_automation_id="tears-of-steel-hls-button" type="submit" class="ghost-button"
                            value="Load Tears of Steel (HLS-VoD)" title="Load Tears of Steel (HLS)">
                    </div>
                </div>
            </fieldset>
        </div>

        <form action="/video-playback-index">
            <input data_test_automation_id="playback-asset-index-button" type="submit" class="ghost-button"
                value="Full video asset index" href="/video-playback-index">
        </form>

    </main>

    <footer>
        <%- include("../../partials/footer") %>
    </footer>
</body>

</html>